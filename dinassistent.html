<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>HSB S칬dert칬rn Chatt</title>
  <style>
    body {
      font-family: sans-serif;
      margin: 0;
      padding: 20px;
      background: #f0f0f0;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
    }

    #chatbox {
      width: 100%;
      max-width: 400px;
      height: auto;
      display: flex;
      flex-direction: column;
      background: #fff;
    }

    #messages {
      flex: 1;
      padding: 16px;
      overflow-y: auto;
      background: #f5f5f5;
    }

    #inputArea {
      display: flex;
      padding: 12px;
      background: #fff;
      border-top: 1px solid #ccc;
    }

    .message {
      margin-bottom: 12px;
      white-space: pre-line;
      padding: 8px 12px;
      border-radius: 8px;
    }
    .user {
      text-align: right;
      color: #00558c;
      background: #e6f7ff;
      align-self: flex-end;
    }
    .bot {
      text-align: left;
      color: #333;
      background: #f9f9f9;
      align-self: flex-start;
    }
    .bot strong {
      display: inline;
      font-weight: bold;
      margin-right: 4px;
    }
    input {
      flex: 1;
      padding: 10px;
      border-radius: 6px;
      border: 1px solid #ccc;
      margin-right: 8px;
      outline: none;
    }
    button {
      background: #00558c;
      color: white;
      border: none;
      border-radius: 6px;
      padding: 10px 16px;
      cursor: pointer;
      font-weight: bold;
    }

    @media (max-width: 600px) {
      body {
        padding: 0;
        display: flex;
        justify-content: center;
        align-items: flex-start;
      }
      #chatbox {
        max-width: 100%;
        height: auto;
        margin-top: 20px;
      }
      #messages {
        max-height: 60vh;
        overflow-y: auto;
        padding: 12px;
      }
      #inputArea {
        position: static;
        width: 100%;
        border-top: 1px solid #ccc;
      }
    }
  </style>
</head>
<body>

<div id="chatbox">
  <div id="messages">
    <div class="message bot" id="initialBotMessage"><strong>游뱄 HSB Assistent:</strong> Hej! Jag 칛r HSB S칬dert칬rns AI-assistent. Vad vill du ha hj칛lp med idag?</div>
  </div>
  <div id="inputArea">
    <input type="text" id="userInput" placeholder="Skriv din fr친ga h칛r..." />
    <button onclick="sendMessage()">Skicka</button>
  </div>
</div>

<script>
  async function sendMessage() {
    const input = document.getElementById("userInput");
    const message = input.value.trim();
    if (!message) return;

    addMessage(message, "user");
    input.value = "";

    const response = await getAIResponse(message);
    await displayBotMessage(response);
  }

  function addMessage(text, sender) {
    const messages = document.getElementById("messages");
    const div = document.createElement("div");
    div.className = "message " + sender;
    div.innerText = text;
    messages.appendChild(div);
    messages.scrollTop = messages.scrollHeight;
  }

  async function displayBotMessage(text) {
    const messages = document.getElementById("messages");
    const div = document.createElement("div");
    div.className = "message bot";
    div.innerHTML = '<strong>游뱄 HSB Assistent:</strong> <span id="typingText"></span>';
    messages.appendChild(div);
    messages.scrollTop = messages.scrollHeight;

    const typingTextElement = document.getElementById("typingText");
    let i = 0;
    const speed = 50;

    return new Promise((resolve) => {
      function typeWriter() {
        if (i < text.length) {
          typingTextElement.textContent += text.charAt(i);
          i++;
          setTimeout(typeWriter, speed);
        } else {
          messages.scrollTop = messages.scrollHeight;
          resolve();
        }
      }
      typeWriter();
    });
  }

  async function getAIResponse(userInput) {
    const lowerInput = userInput.toLowerCase();

    await new Promise(resolve => setTimeout(resolve, 500));

    if (lowerInput.includes("felanm칛lan")) {
      return `Sj칛lvklart! Du kan g칬ra en felanm칛lan direkt via v친r portal:\n游녤 https://hsb.se/sodertorn/kontakt/felanmalan\nOm det g칛ller n친got akut, som en vattenl칛cka eller str칬mavbrott, kan du 칛ven ringa v친r jour: 08-608 68 00.\nBeh칬ver du hj칛lp med att fylla i felanm칛lan?`;
    }

    if (lowerInput.includes("parkering")) {
      return `Bra att du fr친gar! F칬r parkeringsfr친gor rekommenderar jag att du kontaktar din brf-styrelse direkt, eftersom varje f칬rening har olika avtal.\nDu kan ocks친 h칬ra av dig till v친r kundservice s친 hj칛lper vi dig vidare.\nVill du att jag visar kontaktuppgifterna?`;
    }

    if (lowerInput.includes("kontakt") || lowerInput.includes("mejla")) {
      return `Du kan alltid kontakta v친r kundservice via:\n游 Telefon: 08-608 68 00\n游닎 E-post: info.sodertorn@hsb.se\nVill du att jag skickar dig vidare till kontaktformul칛ret?`;
    }

    return `Tack f칬r din fr친ga! Jag 칛r inte helt s칛ker p친 svaret just nu, men jag kan hj칛lpa dig att hitta r칛tt.\nVill du att jag kopplar dig vidare till v친r kundservice eller guidar dig vidare? 游땕`;
  }

  displayInitialBotMessage();

  async function displayInitialBotMessage() {
    const initialMessageElement = document.getElementById("initialBotMessage");
    const fullText = initialMessageElement.textContent;
    initialMessageElement.innerHTML = '<strong>游뱄 HSB Assistent:</strong> <span id="initialTypingText"></span>';
    const typingTextElement = document.getElementById("initialTypingText");
    let i = 0;
    const speed = 50;

    return new Promise((resolve) => {
      function typeWriter() {
        if (i < fullText.length) {
          typingTextElement.textContent += fullText.charAt(i);
          i++;
          setTimeout(typeWriter, speed);
        } else {
          document.getElementById("messages").scrollTop = document.getElementById("messages").scrollHeight;
          resolve();
        }
      }
      typeWriter();
    });
  }

  document.getElementById("userInput").addEventListener("keydown", function(event) {
    if (event.key === "Enter") {
      event.preventDefault();
      sendMessage();
    }
  });
</script>

</body>
</html>
